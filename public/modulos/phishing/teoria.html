<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>M√≥dulo 2: Phishing - NoHaxx</title>
  <link rel="stylesheet" href="../../style.css">
  <style>
    /* --- ESTILOS GENERALES --- */
    body { background-color: #f4f4f4; }

    .lms-container {
      display: flex;
      max-width: 1200px;
      margin: 2rem auto;
      background: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
      min-height: 650px;
    }

    /* BARRA LATERAL */
    .lms-sidebar {
      width: 25%;
      background-color: #f8f9fa;
      border-right: 1px solid #ddd;
      padding: 20px;
    }
    .lms-sidebar h3 { font-size: 1.1rem; border-bottom: 2px solid #0f1e40; padding-bottom: 10px; margin-bottom: 20px; }
    .lms-menu-item {
      padding: 12px 15px; margin-bottom: 8px; color: #555; border-radius: 5px; cursor: not-allowed; opacity: 0.6; /* Bloqueado por defecto */
      font-size: 0.95rem; transition: all 0.2s;
    }
    .lms-menu-item.unlocked { cursor: pointer; opacity: 1; } /* Desbloqueado */
    .lms-menu-item.active { background-color: #0f1e40; color: white; font-weight: bold; opacity: 1; }
    .lms-menu-item.completed::after { content: " ‚úì"; color: #4caf50; font-weight: bold; }

    /* CONTENIDO */
    .lms-content { width: 75%; padding: 40px; display: flex; flex-direction: column; position: relative; }
    .course-step { display: none; animation: fadeIn 0.5s; }
    .course-step.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* ELEMENTOS INTERACTIVOS (Juego) */
    .interactive-item {
      background: #fff; border: 2px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px; cursor: pointer; transition: 0.3s;
    }
    .interactive-item:hover { border-color: #0f1e40; background: #f0f8ff; }
    .interactive-item.checked { border-color: #28a745; background: #d4edda; color: #155724; }
    .interactive-item.checked::after { content: " ‚úÖ"; float: right; }

    /* TARJETAS DE TIPOS (Paso 3) */
    .card-interactiva {
      background: #fff; border: 1px solid #ccc; padding: 20px; border-radius: 8px; cursor: pointer; min-width: 200px; flex: 1; transition: 0.3s;
    }
    .card-interactiva:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    .card-interactiva.visto { border: 2px solid #28a745; background-color: #e8f5e9; }

    /* EMAIL FAKE (Paso 4) */
    .email-simulacion { border: 1px solid #ccc; border-radius: 5px; background: #fff; padding: 20px; margin: 20px 0; font-family: sans-serif; }
    .fake-link { color: blue; text-decoration: underline; cursor: help; font-weight: bold; padding: 2px 5px; border-radius: 3px; }
    .fake-link:hover { background-color: yellow; } /* Feedback visual al pasar rat√≥n */
    
    /* TOOLTIP */
    .fake-link:hover::after {
      content: "‚ö†Ô∏è URL REAL: http://hacker-site.tk";
      position: absolute; background: #d9534f; color: #fff; padding: 5px 10px; border-radius: 4px; font-size: 0.8rem; margin-left: 10px; white-space: nowrap; z-index: 100;
    }

    /* BOTONES DE NAVEGACI√ìN */
    .navigation-buttons { margin-top: auto; display: flex; justify-content: space-between; border-top: 1px solid #eee; padding-top: 20px; align-items: center; }
    .btn-nav { padding: 10px 25px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: background 0.3s; }
    .btn-prev { background-color: #e0e0e0; color: #333; }
    
    /* Bot√≥n Siguiente BLOQUEADO */
    .btn-next { background-color: #0f1e40; color: white; }
    .btn-next:disabled { background-color: #ccc; cursor: not-allowed; opacity: 0.7; }

    .instruccion-bloqueo { color: #d9534f; font-size: 0.9rem; font-weight: bold; margin-right: 15px; display: none; }
    .btn-next:disabled + .instruccion-bloqueo { display: block; } /* Hack CSS: mostrar mensaje si bot√≥n disabled */

    .btn-finish { background-color: #28a745; color: white; display: none; text-decoration: none; padding: 10px 25px; border-radius: 5px; font-weight: bold; }
  </style>
</head>
<body>

  <header>
    <div class="logo">NoHaxx</div>
    <div class="top-buttons">
      <a href="../../modulos.html">Salir del M√≥dulo</a>
    </div>
  </header>

  <div class="lms-container">
    
    <aside class="lms-sidebar">
      <h3>üìë √çndice del Curso</h3>
      <div class="lms-menu-item unlocked active" id="menu-0">1. Introducci√≥n</div>
      <div class="lms-menu-item" id="menu-1">2. Anatom√≠a de un Ataque</div>
      <div class="lms-menu-item" id="menu-2">3. Tipos de Phishing</div>
      <div class="lms-menu-item" id="menu-3">4. Pr√°ctica: Hovering</div>
      <div class="lms-menu-item" id="menu-4">5. Conclusi√≥n</div>
    </aside>

    <main class="lms-content">

      <div class="course-step active">
        <h2>1. ¬øQu√© es el Phishing?</h2>
        <p>El phishing es el arte de enga√±ar a las personas para que compartan informaci√≥n confidencial. A diferencia de los virus, que atacan al software, el phishing ataca a tu mente.</p>
        <p>Los ciberdelincuentes lanzan un "anzuelo" (generalmente un correo o SMS) esperando que piques. Si lo haces, pueden robar tus contrase√±as, tu dinero o los datos de tu empresa.</p>
        <div style="background: #e3f2fd; padding: 15px; border-radius: 5px;">
          <strong>üí° Dato clave:</strong> El 90% de los ciberataques exitosos comienzan con un error humano, no con un fallo t√©cnico.
        </div>
      </div>

      <div class="course-step">
        <h2>2. Detectives de Correo</h2>
        <p>Para desbloquear el bot√≥n "Siguiente", debes encontrar e identificar las <strong>3 se√±ales de alerta</strong> haciendo clic sobre ellas:</p>
        
        <div id="activity-2">
          <div class="interactive-item" onclick="checkItem(2, this)">
            <strong>üö© Urgencia o Miedo:</strong> "¬°Tu cuenta ser√° eliminada en 24 horas!". Si te meten prisa, sospecha.
          </div>
          <div class="interactive-item" onclick="checkItem(2, this)">
            <strong>üö© Remitente Extra√±o:</strong> Dice ser "Netflix", pero el correo es <code>admin@net-flix-update.com</code>.
          </div>
          <div class="interactive-item" onclick="checkItem(2, this)">
            <strong>üö© Enlaces Trampa:</strong> El texto del enlace no coincide con la direcci√≥n web real.
          </div>
        </div>
      </div>

      <div class="course-step">
        <h2>3. Variantes del Phishing</h2>
        <p>Haz clic en cada tarjeta para leer su definici√≥n y marcarla como "Vista".</p>
        
        <div class="tarjetas-container" id="activity-3">
          <div class="card-interactiva" onclick="checkCard(3, this)">
            <h4>üì± Smishing</h4>
            <p>Ataques a trav√©s de <strong>SMS</strong>. Muy com√∫n con supuestos paquetes de mensajer√≠a pendientes.</p>
          </div>
          <div class="card-interactiva" onclick="checkCard(3, this)">
            <h4>üìû Vishing</h4>
            <p>Ataques por <strong>voz</strong> (llamadas telef√≥nicas). El estafador se hace pasar por un t√©cnico o el banco.</p>
          </div>
          <div class="card-interactiva" onclick="checkCard(3, this)">
            <h4>üéØ Spear Phishing</h4>
            <p>Ataques <strong>dirigidos</strong> a una persona concreta, usando su nombre y datos reales para ganar confianza.</p>
          </div>
        </div>
      </div>

      <div class="course-step">
        <h2>4. La T√©cnica del "Hovering"</h2>
        <p>Antes de hacer clic en un enlace, debes pasar el rat√≥n por encima para ver a d√≥nde lleva realmente. ¬°A veces lo que ves no es lo que parece!</p>
        
        <div style="background: #fff3cd; border: 1px solid #ffeeba; padding: 10px; margin-bottom: 20px;">
          <strong>Misi√≥n:</strong> Pasa el rat√≥n (o toca en m√≥vil) sobre el enlace "Actualizar ahora" dentro del correo falso para descubrir la estafa.
        </div>

        <div class="email-simulacion">
          <div class="email-header">
            <strong>De:</strong> Soporte IT &lt;soporte@empresa-segura.tk&gt;<br>
            <strong>Asunto:</strong> Cambio de contrase√±a obligatorio
          </div>
          <div class="email-body">
            <p>Hola,</p>
            <p>Su contrase√±a ha caducado. Haga clic abajo para renovarla:</p>
            <p>
              <span class="fake-link" onmouseover="unlockStep(4)" onclick="unlockStep(4)">
                üëâ Actualizar ahora
              </span>
            </p>
          </div>
        </div>
        <p id="msg-hover" style="color:green; font-weight:bold; display:none;">¬°Bien hecho! Has descubierto la URL maliciosa.</p>
      </div>

      <div class="course-step">
        <h2>5. ¬°M√≥dulo Completado!</h2>
        <p>Has aprendido a identificar las se√±ales de peligro y a verificar enlaces antes de hacer clic.</p>
        <ul>
          <li>‚úÖ Sabes detectar la urgencia falsa.</li>
          <li>‚úÖ Conoces las variantes (SMS, Voz).</li>
          <li>‚úÖ Dominas el "Hovering".</li>
        </ul>
        <p>Est√°s listo para el examen final.</p>
      </div>

      <div class="navigation-buttons">
        <button class="btn-nav btn-prev" id="prevBtn" onclick="changeStep(-1)">Anterior</button>
        
        <div style="display:flex; align-items:center;">
          <span id="bloqueo-msg" class="instruccion-bloqueo">‚ö†Ô∏è Completa las acciones para avanzar</span>
          <button class="btn-nav btn-next" id="nextBtn" onclick="changeStep(1)">Siguiente ‚ûú</button>
        </div>

        <a href="examen.html" class="btn-finish" id="finishBtn">Ir al Examen Final</a>
      </div>

    </main>
  </div>

  <script>
    let currentStep = 0;
    const totalSteps = 5;
    
    // Estado de desbloqueo de cada paso: [Paso1, Paso2, Paso3, Paso4, Paso5]
    // Paso 1 (Intro) y Paso 5 (Fin) siempre est√°n desbloqueados (true)
    let stepUnlocked = [true, false, false, false, true]; 

    // Contadores para las actividades
    let itemsClickedStep2 = 0;
    let cardsClickedStep3 = 0;

    const steps = document.querySelectorAll('.course-step');
    const menuItems = document.querySelectorAll('.lms-menu-item');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const finishBtn = document.getElementById('finishBtn');
    const bloqueoMsg = document.getElementById('bloqueo-msg');

    function updateUI() {
      // 1. Mostrar el paso actual
      steps.forEach((step, index) => {
        step.classList.remove('active');
        menuItems[index].classList.remove('active');
        
        if (index < currentStep) menuItems[index].classList.add('completed');
        
        // Gesti√≥n del men√∫ (solo clickable si ya pasaste por ah√≠)
        if (index <= currentStep || stepUnlocked[index-1]) {
           menuItems[index].classList.add('unlocked');
           menuItems[index].onclick = () => goToStep(index);
        }
      });

      steps[currentStep].classList.add('active');
      menuItems[currentStep].classList.add('active');

      // 2. Gesti√≥n del bot√≥n ANTERIOR
      prevBtn.style.visibility = (currentStep === 0) ? 'hidden' : 'visible';

      // 3. Gesti√≥n del bot√≥n SIGUIENTE y FINALIZAR
      if (currentStep === totalSteps - 1) {
        nextBtn.style.display = 'none';
        finishBtn.style.display = 'inline-block';
        bloqueoMsg.style.display = 'none';
      } else {
        nextBtn.style.display = 'inline-block';
        finishBtn.style.display = 'none';
        
        // Bloquear o Desbloquear el bot√≥n siguiente
        if (stepUnlocked[currentStep]) {
            nextBtn.disabled = false;
            bloqueoMsg.style.display = 'none';
        } else {
            nextBtn.disabled = true;
            bloqueoMsg.style.display = 'block';
        }
      }
    }

    function changeStep(n) {
      if (n === 1 && !stepUnlocked[currentStep]) return; // Seguridad extra
      currentStep += n;
      if (currentStep >= totalSteps) currentStep = totalSteps - 1;
      if (currentStep < 0) currentStep = 0;
      updateUI();
    }

    function goToStep(n) {
      // Solo permite ir si el paso anterior est√° desbloqueado
      if (n > 0 && !stepUnlocked[n-1] && n > currentStep) return;
      currentStep = n;
      updateUI();
    }

    // --- L√ìGICA DE LAS ACTIVIDADES ---

    // ACTIVIDAD PASO 2: Clicar 3 elementos
    function checkItem(stepIndex, element) {
      if (element.classList.contains('checked')) return; // Ya clicado
      element.classList.add('checked');
      itemsClickedStep2++;
      
      if (itemsClickedStep2 >= 3) {
        unlockStep(stepIndex);
      }
    }

    // ACTIVIDAD PASO 3: Clicar 3 tarjetas
    function checkCard(stepIndex, element) {
      if (element.classList.contains('visto')) return;
      element.classList.add('visto');
      cardsClickedStep3++;

      if (cardsClickedStep3 >= 3) {
        unlockStep(stepIndex);
      }
    }

    // FUNCI√ìN GEN√âRICA PARA DESBLOQUEAR
    function unlockStep(index) {
      if (!stepUnlocked[index]) {
        stepUnlocked[index] = true;
        
        // Feedback visual si es el hover del paso 4
        if (index === 4) {
            document.getElementById('msg-hover').style.display = 'block';
        }
        
        updateUI(); // Refrescar botones
      }
    }

    // Inicializar
    updateUI();
  </script>
</body>
</html>