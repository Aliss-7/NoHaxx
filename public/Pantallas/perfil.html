<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Perfil de usuario - NoHaxx</title>
  <link rel="icon" type="image/png" href="../img/logo-nohaxx-miniatura.png">
  <link rel="stylesheet" href="../CSS/base.css" />
  <link rel="stylesheet" href="../CSS/dashboard.css" />
  <link rel="stylesheet" href="../CSS/perfil.css" />
  <script src="../scripts/parpadeo.js"></script>
</head>
<body>
  <div id="notificacion"></div>

  <header>
    <div class="logo">
    <a href="/inicio">
        <img src="../img/logo-nohaxx.png" alt="NoHaxx Logo" id="logo-header">
    </a>
    </div>
    <div class="top-buttons">
      <a href="/inicio">Inicio</a>

      <a href="/login" class="menu-invitado">Login</a>
      <a href="/registro" class="menu-invitado">Registro</a>
      <a href="/contacto" class="menu-invitado">Contacto</a>

      <a href="/modulos" class="menu-usuario" style="display: none;">Módulos</a>
      <a href="/resultados" class="menu-usuario" style="display: none;">Resultados</a>
      <a href="/perfil" class="menu-usuario" style="display: none;">Perfil</a>
      <a href="/contacto" class="menu-usuario" style="display: none;">Contacto</a>
      <a href="#" onclick="cerrarSesion()" class="menu-usuario" style="background-color: #d32f2f; color: white; display: none;">Cerrar sesión</a>
    </div>
  </header>

  <main class="main-content">
    
    <div class="layout-perfil">

      <aside class="sidebar-perfil">
        <div class="card-identidad">
          <div class="avatar-grande">
            <span id="avatar-letra">U</span>
          </div>
          <p class="email-texto" id="email-sidebar">Cargando...</p>
          <div class="etiqueta-rol">Usuario</div>
        </div>

        <div class="card-progreso-lateral">
          <h3>Barra de progreso</h3>
          <div class="barra-contenedor">
            <div class="barra-progreso" id="barra-progreso"></div>
          </div>
          <p class="texto-ayuda">Completa los módulos para subir tu nivel.</p>
        </div>
      </aside>

      <section class="contenido-datos">
        <div class="card-formulario">
          <div class="header-formulario">
            <h1>Mis Datos Personales</h1>
            <button class="boton-editar" id="editar-btn">
              Editar Perfil
            </button>
          </div>

          <div class="grid-inputs">
            
            <div class="grupo-input">
              <label for="nombre">Nombre</label>
              <input type="text" id="nombre" disabled placeholder="Tu nombre" />
            </div>

            <div class="grupo-input">
              <label for="apellidos">Apellidos</label>
              <input type="text" id="apellidos" disabled placeholder="Tus apellidos" />
            </div>

            <div class="grupo-input">
              <label for="telefono">Teléfono</label>
              <input type="text" id="telefono" disabled placeholder="+34 000 000 000" />
            </div>

            <div class="grupo-input">
              <label for="departamento">Departamento</label>
              <input type="text" id="departamento" disabled placeholder="Ej. Marketing" />
            </div>

            <div class="grupo-input full-width">
              <label>Correo Electrónico (No editable)</label>
              <span id="email" class="input-falso">Cargando...</span>
            </div>

          </div>
        </div>
      </section>

    </div>
  </main>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  
  <script src="../scripts/firebase-config.js"></script>
  <script src="../scripts/perfil.js"></script>
  <script src="../scripts/seguridad.js"></script>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
        const auth = firebase.auth();
        auth.onAuthStateChanged(user => {
            if(user && user.email) {
                const letra = user.email.charAt(0).toUpperCase();
                const avatarEl = document.getElementById('avatar-letra');
                const emailSide = document.getElementById('email-sidebar');
                if(avatarEl) avatarEl.innerText = letra;
                if(emailSide) emailSide.innerText = user.email;
            }
        });
    });
  </script>
</body>
</html>